// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Stack Default Testing Should match snapshot 1`] = `
{
  "Parameters": {
    "BootstrapVersion": {
      "Default": "/cdk-bootstrap/hnb659fds/version",
      "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]",
      "Type": "AWS::SSM::Parameter::Value<String>",
    },
  },
  "Resources": {
    "NotificationTopicEB7A0DF1": {
      "Type": "AWS::SNS::Topic",
    },
    "StateMachine2E01A3A5": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "StateMachineRoleDefaultPolicyDF1E6607",
        "StateMachineRoleB840431D",
      ],
      "Properties": {
        "DefinitionString": {
          "Fn::Join": [
            "",
            [
              "{"StartAt":"InitDefinition","States":{"InitDefinition":{"Type":"Pass","Result":{"Statues":[{"key":"RUNNING","value":"Running","emoji":"ü•≥"},{"key":"SUCCEEDED","value":"Succeeded","emoji":"ü§©"},{"key":"FAILED","value":"Failed","emoji":"üò´"},{"key":"TIMED_OUT","value":"TimeOut","emoji":"ü§î"},{"key":"ABORTED","value":"Aborted","emoji":"üòÆ"},{"key":"PENDING_REDRIVE","value":"PenfdingRedrive","emoji":"üßê"}]},"ResultPath":"$.Definition","Next":"isNotMe"},"isNotMe":{"Type":"Choice","Choices":[{"Not":{"Variable":"$$.StateMachine.Id","StringEqualsPath":"$.event.detail.stateMachineArn"},"Next":"PrepareTopicValue"}],"Default":"Skip"},"Skip":{"Type":"Pass","Next":"Succeed"},"Succeed":{"Type":"Succeed"},"PublishMessage":{"Next":"Succeed","Type":"Task","ResultPath":"$.Result.Sns","Resource":"arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":states:::sns:publish","Parameters":{"TopicArn":"",
              {
                "Ref": "NotificationTopicEB7A0DF1",
              },
              "","Message":{"default.$":"$.Generate.Topic.TextMessage","email.$":"$.Generate.Topic.TextMessage"},"MessageStructure":"json","Subject.$":"$.Generate.Topic.Subject"}},"GenerateTopicValue":{"Type":"Pass","ResultPath":"$.Generate.Topic","Parameters":{"Subject.$":"States.Format('{} [{}] AWS Step Functions Execution State Notification [{}][{}]', $.Prepare.Topic.Values.Emoji, $.Prepare.Topic.Values.Status, $.event.account, $.event.region)","TextMessage.$":"States.Format('Account : {}\\nRegion : {}\\nState Machine : {}\\nExecution Name : {}\\n\\n{}', $.event.account, $.event.region, $.Prepare.Topic.Values.StateMachieName, $.Prepare.Topic.Values.ExecutionName, States.Format('https://console.aws.amazon.com/states/home?{}#/v2/executions/details/{}', $.event.region, $.Prepare.Topic.Values.ExecutionArn))"},"Next":"PublishMessage"},"PrepareTopicValue":{"Type":"Pass","ResultPath":"$.Prepare.Topic.Values","Parameters":{"StateMachieName.$":"States.ArrayGetItem(States.StringSplit($.event.detail.stateMachineArn, ':'), 6)","ExecutionName.$":"$.event.detail.name","ExecutionArn.$":"$.event.detail.executionArn","Emoji.$":"States.ArrayGetItem($.Definition.Statues[?(@.key == $.event.detail.status)].emoji, 0)","Status.$":"States.ArrayGetItem($.Definition.Statues[?(@.key == $.event.detail.status)].value, 0)","ContextStateMachineId.$":"$$.StateMachine.Id"},"Next":"GenerateTopicValue"}},"TimeoutSeconds":180}",
            ],
          ],
        },
        "RoleArn": {
          "Fn::GetAtt": [
            "StateMachineRoleB840431D",
            "Arn",
          ],
        },
      },
      "Type": "AWS::StepFunctions::StateMachine",
      "UpdateReplacePolicy": "Delete",
    },
    "StateMachineEventsRoleDBCDECD1": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::IAM::Role",
    },
    "StateMachineEventsRoleDefaultPolicyFB602CA9": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "StateMachine2E01A3A5",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "StateMachineEventsRoleDefaultPolicyFB602CA9",
        "Roles": [
          {
            "Ref": "StateMachineEventsRoleDBCDECD1",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "StateMachineRoleB840431D": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "states.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::IAM::Role",
    },
    "StateMachineRoleDefaultPolicyDF1E6607": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Resource": {
                "Ref": "NotificationTopicEB7A0DF1",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "StateMachineRoleDefaultPolicyDF1E6607",
        "Roles": [
          {
            "Ref": "StateMachineRoleB840431D",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "StepFunctionsExecutionStatusChangeDetectionEventRule270F3930": {
      "Properties": {
        "EventPattern": {
          "detail": {
            "status": [
              "FAILED",
              "TIMED_OUT",
            ],
          },
          "detail-type": [
            "Step Functions Execution Status Change",
          ],
          "source": [
            "aws.states",
          ],
        },
        "State": "ENABLED",
        "Targets": [
          {
            "Arn": {
              "Ref": "StateMachine2E01A3A5",
            },
            "Id": "Target0",
            "InputTransformer": {
              "InputPathsMap": {
                "f1": "$",
              },
              "InputTemplate": "{"event":<f1>,"params":{}}",
            },
            "RoleArn": {
              "Fn::GetAtt": [
                "StateMachineEventsRoleDBCDECD1",
                "Arn",
              ],
            },
          },
        ],
      },
      "Type": "AWS::Events::Rule",
    },
  },
  "Rules": {
    "CheckBootstrapVersion": {
      "Assertions": [
        {
          "Assert": {
            "Fn::Not": [
              {
                "Fn::Contains": [
                  [
                    "1",
                    "2",
                    "3",
                    "4",
                    "5",
                  ],
                  {
                    "Ref": "BootstrapVersion",
                  },
                ],
              },
            ],
          },
          "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI.",
        },
      ],
    },
  },
}
`;
